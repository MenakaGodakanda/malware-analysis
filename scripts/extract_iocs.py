import pefile
import json
import os

def analyze_pe(file_path, output_path):
    pe = pefile.PE(file_path)
    iocs = {
        "entry_point": pe.OPTIONAL_HEADER.AddressOfEntryPoint,
        "image_base": pe.OPTIONAL_HEADER.ImageBase,
        "imports": [entry.dll.decode() for entry in pe.DIRECTORY_ENTRY_IMPORT],
    }
    with open(output_path, 'w') as f:
        json.dump(iocs, f, indent=4)

# Assuming the script is run from the root of the project
sample_path = os.path.join(os.path.dirname(__file__), '../samples/sample.exe')
report_path = os.path.join(os.path.dirname(__file__), '../reports/iocs.json')

analyze_pe(sample_path, report_path)
